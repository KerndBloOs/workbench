# ~/.bashrc
#



###### bash-config #######

# load bash_alias if present
if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

# set editing mode
set -o vi

# env variables
export PATH="$PATH:/opt/nvim-linux64/bin"


# path configuration
setopt extended_glob null_glob

path=(
    $path                           # Keep existing PATH entries
    $HOME/bin
    $HOME/.local/bin
    $HOME/dotnet
    $SCRIPTS
    $HOME/.krew/bin
    $HOME/.rd/bin                   # Rancher Desktop
    /home/vscode/.local/bin         # Dev Container Specifics
    /root/.local/bin                # Dev Container Specifics
)

# Remove duplicate entries and non-existent directories
typeset -U path
path=($^path(N-/))

export PATH

# for dev container
if [ -d "/home/linuxbrew/.linuxbrew" ]; then
     eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# history
export HISTFILE=$HOME/.histfile
export HISTSIZE=50000
export SAVEHIST=50000
export HISTCONTROL=ignorespace

# directories
export GR="$HOME/git-repos"
export GITUSER="mischavandenburg"
export DOTFILES="$HOME/.local/share/chezmoi"



###### tools ######

# neovim
if command -v nvim > /dev/null ; then
  export EDITOR="nvim"
  export VISUAL="nvim"
fi

# starship
if command -v starship > /dev/null ; then
  eval "$(starship init bash)"
fi

# fzf
if command -v fzf > /dev/null ; then
  source <(fzf --bash)
fi

# mise
if command -v mise > /dev/null ; then
  eval "$($HOME/.local/bin/mise activate bash)"
fi

# ssh agent
if [ -z "$SSH_AUTH_SOCK" ] ; then
    eval $(ssh-agent -s)
    ssh-add
fi




###### aliases ######

alias t='/usr/bin/tmux attach || /usr/bin/tmux'
alias c='clear'
alias v='nvim'
alias e='exit'
alias ..="cd .."
alias ll='ls -lgha --color=auto'
alias la='ls -lathr'
alias ds='devpod ssh'
aslias key='eval $(ssh-agent -s); ssh-add

setvar() {
    if [ -z "$loc" ]; then
        echo "insert location"
        return 1
    fi
    export "location=$loc"
}
alias wv='curl "https://wttr.in/$loc?1&F&q"'
alias w='curl "https://wttr.in/$loc?format=1"'

if command -v bat > /dev/null ; then
  alias cat="bat"
fi

# git
alias gp='git pull'
alias gs='git status'
alias gc='git commit -m'
alias lg='lazygit'

# directories
alias gd='cd $HOME/git-repos/dotfiles; ls -la --color=auto'
alias gr='cd $HOME/git-repos/'

# credits to mischavandenburg
# use fp to do a fzf search and preview the files
alias fp="fzf --preview 'bat --style=numbers --color=always --line-range :500 {}'"
# search for a file with fzf and open it in vim
alias vf='vim $(fp)'
